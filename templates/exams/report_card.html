<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Report Card - {{ student.first_name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #eee; padding: 20px; }
        .report-card {
            background: #fff; max-width: 800px; margin: 0 auto;
            padding: 40px; border: 2px solid #333; box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        .school-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 20px; margin-bottom: 20px; }
        .school-logo { height: 80px; margin-bottom: 10px; }
        .table-marks th { background-color: #f8f9fa; text-transform: uppercase; font-size: 0.9rem; }
        .grade-box {
            border: 2px solid #000; padding: 10px; text-align: center; display: inline-block; min-width: 100px;
        }
        
        @media print {
            body { background: #fff; padding: 0; }
            .report-card { border: none; box-shadow: none; margin: 0; width: 100%; max-width: 100%; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>

<div class="report-card">
    
    <div class="school-header">
        {% if student.school.logo %}
            <img src="{{ student.school.logo.url }}" class="school-logo">
        {% endif %}
        <h2 class="fw-bold text-uppercase">{{ student.school.name }}</h2>
        <p class="mb-0">{{ student.school.address }}</p>
        <h5 class="mt-2 bg-dark text-white d-inline-block px-3 py-1 rounded">REPORT CARD</h5>
        <p class="mt-1 fw-bold">{{ exam.name }} (Session 2025-26)</p>
    </div>

    <div class="row mb-4">
        <div class="col-6">
            <p><strong>Name:</strong> {{ student.first_name }} {{ student.last_name }}</p>
            <p><strong>Father's Name:</strong> {{ student.father_name }}</p>
            <p><strong>Date of Birth:</strong> {{ student.dob|default:"-" }}</p>
        </div>
        <div class="col-6 text-end">
            <p><strong>Class:</strong> {{ student.current_class.name }} - {{ student.section.name }}</p>
            <p><strong>Roll No:</strong> {{ student.roll_number|default:"-" }}</p>
            <p><strong>Adm No:</strong> {{ student.admission_no }}</p>
        </div>
    </div>

    <table class="table table-bordered table-marks text-center">
        <thead>
            <tr>
                <th class="text-start">Subject</th>
                <th>Max Marks</th>
                <th>Obtained</th>
                <th>Grade</th>
            </tr>
        </thead>
        <tbody>
            {% for res in results %}
            <tr>
                <td class="text-start fw-bold">{{ res.subject.name }}</td>
                <td>{{ res.subject.total_marks }}</td>
                <td>{{ res.marks_obtained }}</td>
                <td>
                    {% if res.marks_obtained >= 33 %}P{% else %}F{% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot class="table-light fw-bold">
            <tr>
                <td class="text-start">GRAND TOTAL</td>
                <td>{{ total_max }}</td>
                <td>{{ total_obtained }}</td>
                <td>-</td>
            </tr>
        </tfoot>
    </table>

    <div class="row mt-4 align-items-center">
        <div class="col-8">
            <p><strong>Percentage:</strong> {{ percentage }}%</p>
            <p><strong>Result Status:</strong> 
                <span class="{% if status == 'PASS' %}text-success{% else %}text-danger{% endif %} fw-bold">
                    {{ status }}
                </span>
            </p>
            <p><strong>Remarks:</strong> Excellent performance! Keep it up.</p>
        </div>
        <div class="col-4 text-end">
            <div class="grade-box">
                <small>Overall Grade</small><br>
                <h1 class="mb-0">{{ grade }}</h1>
            </div>
        </div>
    </div>

    <div class="row mt-5 pt-5 text-center">
        <div class="col-4"><p>________________<br>Class Teacher</p></div>
        <div class="col-4"><p>________________<br>Parent</p></div>
        <div class="col-4"><p>________________<br>Principal</p></div>
    </div>

    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-primary btn-lg">üñ®Ô∏è Print Report</button>
        <button onclick="window.close()" class="btn btn-secondary btn-lg ms-2">‚ùå Close</button>
    </div>

</div>

</body>
</html>